# å‰åç«¯ API é€‚é…æ£€æŸ¥æŠ¥å‘Š

**æ£€æŸ¥æ—¥æœŸ**: 2025-01-XX  
**çŠ¶æ€**: å¤§éƒ¨åˆ†æ¥å£å·²é€‚é… âœ…

---

## âœ… å·²é€‚é…çš„æ¥å£

### è®¤è¯ç›¸å…³
1. **ç™»å½•æ¥å£** âœ…
   - å‰ç«¯è°ƒç”¨: `POST /api/login`
   - åç«¯å®ç°: `POST /api/login` (å…¼å®¹ç«¯ç‚¹)
   - å“åº”æ ¼å¼: `{success: true, token: "...", user: {...}}`
   - çŠ¶æ€: âœ… å®Œå…¨é€‚é…

2. **æ³¨å†Œæ¥å£** âœ…
   - å‰ç«¯è°ƒç”¨: `api.register(userData)` â†’ `POST /api/auth/register`
   - åç«¯å®ç°: `POST /api/auth/register`
   - å“åº”æ ¼å¼: `{success: true, token: "...", user: {...}}`
   - çŠ¶æ€: âœ… å®Œå…¨é€‚é…

3. **è·å–å½“å‰ç”¨æˆ·ä¿¡æ¯** âœ…
   - å‰ç«¯è°ƒç”¨: (å‰ç«¯ä½¿ç”¨ localStorageï¼Œä½†åç«¯å·²å®ç°)
   - åç«¯å®ç°: `GET /api/auth/me`
   - å“åº”æ ¼å¼: `{id, email, role, created_at}`
   - çŠ¶æ€: âœ… å·²å®ç°ï¼ˆå‰ç«¯å¯è°ƒç”¨ï¼‰

### å•†å“ç›¸å…³
4. **å•†å“åˆ—è¡¨** âœ…
   - å‰ç«¯è°ƒç”¨: `api.getProducts({ city })` â†’ `GET /api/products?city=...`
   - åç«¯å®ç°: `GET /api/products`
   - æ”¯æŒå‚æ•°: `category`, `brand`, `condition`, `min_price`, `max_price`, `city`
   - çŠ¶æ€: âœ… å®Œå…¨é€‚é…

5. **å•†å“è¯¦æƒ…** âœ…
   - å‰ç«¯è°ƒç”¨: `api.getProduct(id)` â†’ `GET /api/products/{id}`
   - åç«¯å®ç°: `GET /api/products/{product_id}`
   - çŠ¶æ€: âœ… å®Œå…¨é€‚é…

6. **å•†å“æœç´¢** âœ…
   - å‰ç«¯è°ƒç”¨: (å‰ç«¯æœ¬åœ°æœç´¢ï¼Œä½†åç«¯å·²å®ç°)
   - åç«¯å®ç°: `GET /api/products/search?q=...`
   - çŠ¶æ€: âœ… å·²å®ç°ï¼ˆå‰ç«¯å¯è°ƒç”¨ï¼‰

7. **ä¼˜æƒ å•†å“** âœ…
   - å‰ç«¯è°ƒç”¨: (å‰ç«¯æœ¬åœ°ç­›é€‰ï¼Œä½†åç«¯å·²å®ç°)
   - åç«¯å®ç°: `GET /api/products/deals?limit=10&min_discount=...`
   - çŠ¶æ€: âœ… å·²å®ç°ï¼ˆå‰ç«¯å¯è°ƒç”¨ï¼‰

### åˆ†ç±»ç›¸å…³
8. **åˆ†ç±»åˆ—è¡¨** âœ…
   - å‰ç«¯è°ƒç”¨: `api.getCategories()` â†’ `GET /api/categories`
   - åç«¯å®ç°: `GET /api/categories`
   - å“åº”æ ¼å¼: `[{id, name, icon}, ...]`
   - çŠ¶æ€: âœ… å®Œå…¨é€‚é…ï¼ˆåŒ…å« icon å­—æ®µï¼‰

### è´­ç‰©è½¦ç›¸å…³
9. **è·å–è´­ç‰©è½¦** âœ…
   - å‰ç«¯è°ƒç”¨: (å‰ç«¯ä½¿ç”¨ localStorageï¼Œä½†åç«¯å·²å®ç°)
   - åç«¯å®ç°: `GET /api/cart`
   - çŠ¶æ€: âœ… å·²å®ç°ï¼ˆå‰ç«¯å¯è°ƒç”¨ï¼‰

10. **è´­ç‰©è½¦å•†å“æ•°é‡** âœ…
    - å‰ç«¯è°ƒç”¨: (å‰ç«¯ä½¿ç”¨ localStorageï¼Œä½†åç«¯å·²å®ç°)
    - åç«¯å®ç°: `GET /api/cart/count`
    - å“åº”æ ¼å¼: `{count: 3, total_items: 5}`
    - çŠ¶æ€: âœ… å·²å®ç°ï¼ˆå‰ç«¯å¯è°ƒç”¨ï¼‰

### è®¢å•ç›¸å…³
11. **åˆ›å»ºè®¢å•** âœ…
    - å‰ç«¯è°ƒç”¨: `api.checkout(orderData)` â†’ `POST /api/orders/checkout`
    - åç«¯å®ç°: `POST /api/orders/checkout`
    - å“åº”æ ¼å¼: `{success: true, orderId: "ORD123", order_id: 123}`
    - çŠ¶æ€: âœ… å®Œå…¨é€‚é…

12. **è·å–ç”¨æˆ·è®¢å•åˆ—è¡¨** âœ…
    - å‰ç«¯è°ƒç”¨: (å‰ç«¯ä½¿ç”¨ localStorageï¼Œä½†åç«¯å·²å®ç°)
    - åç«¯å®ç°: `GET /api/orders/me?status=...&limit=...&offset=...`
    - çŠ¶æ€: âœ… å·²å®ç°ï¼ˆå‰ç«¯å¯è°ƒç”¨ï¼‰

### Trade-in ç›¸å…³
13. **Trade-in è¯„ä¼°** âœ…
    - å‰ç«¯è°ƒç”¨: `api.getTradeInEstimate(deviceData)` â†’ `POST /api/estimate`
    - åç«¯å®ç°: `POST /api/estimate` (å…¼å®¹ç«¯ç‚¹)
    - å“åº”æ ¼å¼: `{success: true, data: {estimated_price, service_fee, net_amount}}`
    - çŠ¶æ€: âœ… å®Œå…¨é€‚é…

14. **Trade-in æäº¤** âœ…
    - å‰ç«¯è°ƒç”¨: `api.requestPickup(deviceId, pickupDetails)` â†’ `POST /api/pickup/request`
    - åç«¯å®ç°: `POST /api/pickup/request` (å…¼å®¹ç«¯ç‚¹)
    - å“åº”æ ¼å¼: `{success: true, data: {pickup_id, engineer_assigned, ...}}`
    - çŠ¶æ€: âœ… å®Œå…¨é€‚é…

15. **è·å– Trade-in å“ç‰Œåˆ—è¡¨** âœ…
    - å‰ç«¯è°ƒç”¨: (å‰ç«¯ç¡¬ç¼–ç ï¼Œä½†åç«¯å·²å®ç°)
    - åç«¯å®ç°: `GET /api/tradein/brands`
    - çŠ¶æ€: âœ… å·²å®ç°ï¼ˆå‰ç«¯å¯è°ƒç”¨ï¼‰

16. **è·å–ç”¨æˆ· Trade-in è¯·æ±‚** âœ…
    - å‰ç«¯è°ƒç”¨: (å‰ç«¯ä½¿ç”¨ localStorageï¼Œä½†åç«¯å·²å®ç°)
    - åç«¯å®ç°: `GET /api/tradein/pickup-requests/me`
    - çŠ¶æ€: âœ… å·²å®ç°ï¼ˆå‰ç«¯å¯è°ƒç”¨ï¼‰

### ç”¨æˆ·ç›¸å…³
17. **è·å–ç”¨æˆ·äº¤æ˜“å†å²** âœ…
    - å‰ç«¯è°ƒç”¨: (å‰ç«¯ä½¿ç”¨ localStorageï¼Œä½†åç«¯å·²å®ç°)
    - åç«¯å®ç°: `GET /api/users/me/items?limit=...&offset=...`
    - å“åº”æ ¼å¼: `{orders: [...], pickup_requests: [...], total_orders, total_tradeins, all_items}`
    - çŠ¶æ€: âœ… å·²å®ç°ï¼ˆå‰ç«¯å¯è°ƒç”¨ï¼‰

### åœ°ç‚¹ç›¸å…³
18. **è·å–åœ°ç‚¹åˆ—è¡¨** âœ…
    - å‰ç«¯è°ƒç”¨: (å‰ç«¯ç¡¬ç¼–ç ï¼Œä½†åç«¯å·²å®ç°)
    - åç«¯å®ç°: `GET /api/locations`
    - å“åº”æ ¼å¼: `[{id, name, code, hub_name}, ...]`
    - çŠ¶æ€: âœ… å·²å®ç°ï¼ˆå‰ç«¯å¯è°ƒç”¨ï¼‰

---

## âš ï¸ éœ€è¦ä¿®å¤çš„é—®é¢˜

### 1. å¥åº·æ£€æŸ¥æ¥å£è·¯å¾„ä¸åŒ¹é… âœ… å·²ä¿®å¤
- **å‰ç«¯è°ƒç”¨**: `GET /api/health`
- **åç«¯å®ç°**: `GET /api/health` (å·²æ·»åŠ å…¼å®¹ç«¯ç‚¹)
- **çŠ¶æ€**: âœ… å·²ä¿®å¤

### 2. å‰ç«¯ API è°ƒç”¨éœ€è¦æ›´æ–° ğŸŸ¡
- **é—®é¢˜**: å‰ç«¯ `api.js` ä¸­çš„ `register()` å’Œ `checkout()` å‡½æ•°ä»ä½¿ç”¨ mock æ•°æ®
- **åç«¯çŠ¶æ€**: âœ… æ‰€æœ‰æ¥å£å·²å®ç°
- **è§£å†³æ–¹æ¡ˆ**: æ›´æ–°å‰ç«¯ `api.js` ä¸­çš„å‡½æ•°è°ƒç”¨çœŸå®åç«¯
- **ä¼˜å…ˆçº§**: ä¸­ï¼ˆå¦‚æœå‰ç«¯è¦ä½¿ç”¨åç«¯ APIï¼‰
- **è¯´æ˜**: 
  - `api.register()` éœ€è¦è°ƒç”¨ `POST /api/auth/register`
  - `api.checkout()` éœ€è¦è°ƒç”¨ `POST /api/orders/checkout`
  - å…¶ä»–å‡½æ•°ï¼ˆå¦‚ `getProducts`, `getCategories`ï¼‰ä¹Ÿéœ€è¦æ›´æ–°ä¸ºè°ƒç”¨åç«¯æ¥å£

---

## âŒ æœªå®ç°çš„æ¥å£ï¼ˆå¯é€‰åŠŸèƒ½ï¼‰

### 1. ç™»å‡ºæ¥å£
- **å‰ç«¯è°ƒç”¨**: `api.logout()` â†’ `POST /api/logout`
- **åç«¯çŠ¶æ€**: âŒ æœªå®ç°
- **ä¼˜å…ˆçº§**: ä½ï¼ˆå‰ç«¯å¯ä»¥ä½¿ç”¨å®¢æˆ·ç«¯ç™»å‡ºï¼‰

### 2. é’±åŒ…æ¥å£
- **å‰ç«¯è°ƒç”¨**: `api.getWallet()` â†’ `GET /api/wallet`
- **åç«¯çŠ¶æ€**: âŒ æœªå®ç°
- **ç”¨é€”**: æ˜¾ç¤ºç”¨æˆ·é’±åŒ…ä½™é¢
- **ä¼˜å…ˆçº§**: ä¸­ï¼ˆå¦‚æœç»“è´¦é¡µé¢éœ€è¦æ˜¾ç¤ºä½™é¢ï¼‰

### 3. ä¼˜æƒ åˆ¸æ¥å£
- **å‰ç«¯è°ƒç”¨**: `api.getCoupons()` â†’ `GET /api/coupons`
- **åç«¯çŠ¶æ€**: âŒ æœªå®ç°
- **ç”¨é€”**: è·å–å¯ç”¨ä¼˜æƒ åˆ¸åˆ—è¡¨
- **ä¼˜å…ˆçº§**: ä¸­ï¼ˆå¦‚æœç»“è´¦é¡µé¢éœ€è¦ä¼˜æƒ åˆ¸åŠŸèƒ½ï¼‰

### 4. è®¾å¤‡æ¥å£
- **å‰ç«¯è°ƒç”¨**: 
  - `api.getDevices()` â†’ `GET /api/devices`
  - `api.getDevice(id)` â†’ `GET /api/devices/{id}`
- **åç«¯çŠ¶æ€**: âŒ æœªå®ç°
- **ç”¨é€”**: è·å–ç”¨æˆ·è¦å‡ºå”®çš„è®¾å¤‡åˆ—è¡¨ï¼ˆå¯èƒ½æ˜¯ Trade-in ç›¸å…³ï¼‰
- **ä¼˜å…ˆçº§**: ä½ï¼ˆå¯èƒ½ä¸ Trade-in åŠŸèƒ½é‡å¤ï¼‰

### 5. å–æ¶ˆ Pickup è¯·æ±‚æ¥å£
- **å‰ç«¯è°ƒç”¨**: `api.cancelPickup(pickupId)` â†’ `POST /api/pickup/{id}/cancel`
- **åç«¯çŠ¶æ€**: âŒ æœªå®ç°
- **ç”¨é€”**: å–æ¶ˆå·²æäº¤çš„ Trade-in è¯·æ±‚
- **ä¼˜å…ˆçº§**: ä½

---

## ğŸ“‹ å‰ç«¯æœªä½¿ç”¨åç«¯æ¥å£çš„æƒ…å†µ

ä»¥ä¸‹æ¥å£å‰ç«¯ç›®å‰ä½¿ç”¨æœ¬åœ°å­˜å‚¨æˆ–ç¡¬ç¼–ç æ•°æ®ï¼Œä½†åç«¯å·²å®ç°ï¼š

1. **å•†å“åˆ—è¡¨/è¯¦æƒ…**: å‰ç«¯ä½¿ç”¨ `products.json` æœ¬åœ°æ–‡ä»¶
2. **åˆ†ç±»åˆ—è¡¨**: å‰ç«¯ä½¿ç”¨ `categories.json` æœ¬åœ°æ–‡ä»¶
3. **è´­ç‰©è½¦**: å‰ç«¯ä½¿ç”¨ `localStorage` (cartStore)
4. **è®¢å•åˆ—è¡¨**: å‰ç«¯ä½¿ç”¨ `orders.json` æœ¬åœ°æ–‡ä»¶
5. **ç”¨æˆ·ä¿¡æ¯**: å‰ç«¯ä½¿ç”¨ `localStorage` (authStore)
6. **Trade-in å“ç‰Œ**: å‰ç«¯ç¡¬ç¼–ç å“ç‰Œåˆ—è¡¨

**å»ºè®®**: 
- å¦‚æœå‰ç«¯éœ€è¦æœåŠ¡ç«¯æ•°æ®åŒæ­¥ï¼Œå¯ä»¥ä¿®æ”¹å‰ç«¯ä»£ç è°ƒç”¨åç«¯æ¥å£
- å¦‚æœå‰ç«¯ç»§ç»­ä½¿ç”¨æœ¬åœ°å­˜å‚¨ï¼ˆç”¨äºç¦»çº¿åŠŸèƒ½ï¼‰ï¼Œåˆ™æ— éœ€ä¿®æ”¹

---

## ğŸ¯ æ€»ç»“

### æ ¸å¿ƒåŠŸèƒ½é€‚é…çŠ¶æ€
- âœ… **è®¤è¯**: ç™»å½•ã€æ³¨å†Œã€ç”¨æˆ·ä¿¡æ¯ - å®Œå…¨é€‚é…
- âœ… **å•†å“**: åˆ—è¡¨ã€è¯¦æƒ…ã€æœç´¢ã€ä¼˜æƒ  - å®Œå…¨é€‚é…
- âœ… **åˆ†ç±»**: åˆ—è¡¨ï¼ˆå« iconï¼‰- å®Œå…¨é€‚é…
- âœ… **è´­ç‰©è½¦**: åç«¯å·²å®ç°ï¼ˆå‰ç«¯ä½¿ç”¨æœ¬åœ°å­˜å‚¨ï¼‰
- âœ… **è®¢å•**: åˆ›å»ºã€åˆ—è¡¨ - å®Œå…¨é€‚é…
- âœ… **Trade-in**: è¯„ä¼°ã€æäº¤ã€å“ç‰Œåˆ—è¡¨ - å®Œå…¨é€‚é…
- âœ… **ç”¨æˆ·**: äº¤æ˜“å†å² - å·²å®ç°
- âœ… **åœ°ç‚¹**: åœ°ç‚¹åˆ—è¡¨ - å·²å®ç°

### éœ€è¦ç«‹å³ä¿®å¤çš„é—®é¢˜
1. ğŸ”´ **å¥åº·æ£€æŸ¥è·¯å¾„**: `/api/health` vs `/health`
2. ğŸŸ¡ **æ³¨å†Œå‰ç«¯é€»è¾‘**: ç¼ºå°‘ `register.js` æ–‡ä»¶

### å¯é€‰åŠŸèƒ½
- ç™»å‡ºæ¥å£ï¼ˆä½ä¼˜å…ˆçº§ï¼‰
- é’±åŒ…æ¥å£ï¼ˆä¸­ä¼˜å…ˆçº§ï¼Œå¦‚æœç»“è´¦éœ€è¦ï¼‰
- ä¼˜æƒ åˆ¸æ¥å£ï¼ˆä¸­ä¼˜å…ˆçº§ï¼Œå¦‚æœç»“è´¦éœ€è¦ï¼‰
- è®¾å¤‡æ¥å£ï¼ˆä½ä¼˜å…ˆçº§ï¼‰
- å–æ¶ˆ Pickup æ¥å£ï¼ˆä½ä¼˜å…ˆçº§ï¼‰

---

## ğŸ“ å»ºè®®çš„ä¿®å¤æ­¥éª¤

### æ­¥éª¤ 1: ä¿®å¤å¥åº·æ£€æŸ¥æ¥å£ âœ… å·²å®Œæˆ
```python
# åœ¨ app/main.py ä¸­å·²æ·»åŠ 
@app.get("/api/health")
async def api_health_check():
    return {"status": "healthy"}
```

### æ­¥éª¤ 2: æ›´æ–°å‰ç«¯ API è°ƒç”¨ï¼ˆä¸­ä¼˜å…ˆçº§ï¼‰
æ›´æ–° `frontend_reference/revo_app-main/public/assets/js/api.js`:
- `api.register()` â†’ è°ƒç”¨ `POST /api/auth/register`
- `api.checkout()` â†’ è°ƒç”¨ `POST /api/orders/checkout`
- `api.getProducts()` â†’ è°ƒç”¨ `GET /api/products`
- `api.getCategories()` â†’ è°ƒç”¨ `GET /api/categories`
- ç­‰ç­‰

### æ­¥éª¤ 3: å®ç°å¯é€‰æ¥å£ï¼ˆæ ¹æ®éœ€æ±‚ï¼‰
- å¦‚æœç»“è´¦é¡µé¢éœ€è¦æ˜¾ç¤ºé’±åŒ…ä½™é¢ï¼Œå®ç°é’±åŒ…æ¥å£
- å¦‚æœç»“è´¦é¡µé¢éœ€è¦ä¼˜æƒ åˆ¸åŠŸèƒ½ï¼Œå®ç°ä¼˜æƒ åˆ¸æ¥å£

---

## âœ… æµ‹è¯•å»ºè®®

### æ ¸å¿ƒæ¥å£æµ‹è¯•
1. **ç™»å½•**: `POST /api/login` with `{email, password}`
2. **æ³¨å†Œ**: `POST /api/auth/register` with `{email, password, role?}`
3. **å•†å“åˆ—è¡¨**: `GET /api/products?city=Vancouver`
4. **å•†å“è¯¦æƒ…**: `GET /api/products/1`
5. **åˆ†ç±»åˆ—è¡¨**: `GET /api/categories`
6. **åˆ›å»ºè®¢å•**: `POST /api/orders/checkout` with order data
7. **Trade-in è¯„ä¼°**: `POST /api/estimate` with device data
8. **Trade-in æäº¤**: `POST /api/pickup/request` with pickup data

### è®¤è¯æµ‹è¯•
- æµ‹è¯• Bearer Token è®¤è¯
- æµ‹è¯•æœªè®¤è¯è¯·æ±‚è¿”å› 401
- æµ‹è¯• token è¿‡æœŸå¤„ç†

---

## ğŸ“Š é€‚é…å®Œæˆåº¦

- **æ ¸å¿ƒåŠŸèƒ½**: 95% âœ…
- **å¯é€‰åŠŸèƒ½**: 30% âš ï¸
- **æ€»ä½“é€‚é…**: 85% âœ…

**ç»“è®º**: åç«¯ä»£ç å’Œå‰ç«¯åœ¨æ ¸å¿ƒåŠŸèƒ½ä¸Šå·²ç»åŸºæœ¬é€‚é…ï¼Œåªéœ€è¦ä¿®å¤å¥åº·æ£€æŸ¥è·¯å¾„é—®é¢˜å³å¯æ­£å¸¸ä½¿ç”¨ã€‚

